{
  "name": "è®¾å¤‡å€Ÿè¿˜ç®¡ç†ç³»ç»Ÿ",
  "nodes": [
    {
      "parameters": {
        "formTitle": "è®¾å¤‡å½’è¿˜ç”³è¯·è¡¨",
        "formFields": {
          "values": [
            {
              "fieldLabel": "CDSID",
              "requiredField": true
            },
            {
              "fieldLabel": "è®¾å¤‡ç¼–å·",
              "requiredField": true
            },
            {
              "fieldLabel": "è®¾å¤‡çŠ¶å†µ",
              "requiredField": true
            },
            {
              "fieldLabel": "é—®é¢˜æè¿°"
            },
            {
              "fieldLabel": "é‚®ç®±åœ°å€",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        48,
        1328
      ],
      "id": "73a9c190-f50f-4fa6-b4c8-6a89aa8a5280",
      "name": "å½’è¿˜ç”³è¯·è§¦å‘",
      "webhookId": "d18d7635-aa47-4c04-a9a8-817af9ecffbd"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "çŠ¶æ€": "å¯ç”¨",
            "å€Ÿç”¨æ—¶é—´": "=",
            "è®¾å¤‡ç¼–å·": "={{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['è®¾å¤‡ç¼–å·'] }}",
            "å½“å‰ä½¿ç”¨è€…": "=",
            "é¢„è®¡å½’è¿˜æ—¶é—´": "=",
            "å€Ÿç”¨äººé‚®ç®±": "="
          },
          "matchingColumns": [
            "è®¾å¤‡ç¼–å·"
          ],
          "schema": [
            {
              "id": "è®¾å¤‡ç¼–å·",
              "displayName": "è®¾å¤‡ç¼–å·",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è®¾å¤‡åç§°",
              "displayName": "è®¾å¤‡åç§°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çŠ¶æ€",
              "displayName": "çŠ¶æ€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æ‰€æœ‰è€…",
              "displayName": "æ‰€æœ‰è€…",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ‰€æœ‰è€…é‚®ç®±",
              "displayName": "æ‰€æœ‰è€…é‚®ç®±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ‰€åœ¨åœ°å€",
              "displayName": "æ‰€åœ¨åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å½“å‰ä½¿ç”¨è€…",
              "displayName": "å½“å‰ä½¿ç”¨è€…",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å€Ÿç”¨äººé‚®ç®±",
              "displayName": "å€Ÿç”¨äººé‚®ç®±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å€Ÿç”¨æ—¶é—´",
              "displayName": "å€Ÿç”¨æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é¢„è®¡å½’è¿˜æ—¶é—´",
              "displayName": "é¢„è®¡å½’è¿˜æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1984,
        928
      ],
      "id": "dc84e619-4b52-4026-9127-157f10dbf152",
      "name": "æ›´æ–°è®¾å¤‡çŠ¶æ€2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "public": true,
        "initialMessages": "Hi there! ğŸ‘‹\nYou can ask me things like: â€œIs the Rig available next week?â€  â€œWhere is the neo VI?â€  â€œWho borrowed the SIM card?â€  â€œæœ‰å¤šå°‘ä¸ªæ‰‹æœºå¯å€Ÿ?â€  \"æˆ‘æƒ³å€Ÿç”¨æ ‘è“æ´¾\" Feel free to ask anything!",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        -640,
        192
      ],
      "id": "141fe7ff-5bd3-4505-9654-c94b60c2ee41",
      "name": "When chat message received",
      "webhookId": "8dbbcb2b-b481-43f3-87c5-611e19916e93"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.chatInput }}\nFirst, check the sheet for equipment that might be related to what the user wants. Users usually donâ€™t provide an exact name or IDâ€”they might just give a general category or use different wording. You should first run a fuzzy search across the sheet to pull any gear that might match.\nFor every possible item print the full details (e.g. id, name, category, description, total / available qty, next-available date if out of stock).\n\nIf the user shows intent to book (keywords: â€œbookâ€, â€œreserveâ€, â€œborrowâ€, â€œrentâ€, â€œuseâ€, etc.) , check if itâ€™s available (you should make this judgment). If it is available, give them this link: https://tinac41025.app.n8n.cloud/form/64850e9c-37a4-4183-ad19-7e7644d91f58(it must be output as a hyperlink) and tell them to fill out the form. If itâ€™s not available, let the user know that itâ€™s not available, who is borrowing and the expected returned date.\n\nIf the user wants to locate a tool (keywords: â€œwhereâ€, â€œlocationâ€, â€œplacedâ€, â€œwho borrowâ€, â€œroomâ€, â€œsiteâ€, â€œå“ªè£¡â€, â€œåœ¨å“ªâ€, â€œä½ç½®â€, â€œæ”¾â€ï¼Œ â€œåœ¨è°é‚£â€ï¼Œ â€œè°å€Ÿ\"\"), search the sheet for that item and return its exact location string (e.g. â€œRDCâ€, â€œNew bundâ€, â€œborrowerâ€).\nIf the location is missing or blank, notify the user.\nIf the tool is being borrowed, notify user who is the latest borrower, and the expected return date.\nIf user want to return the device,give them this link: https://tinac41025.app.n8n.cloud/form/d18d7635-aa47-4c04-a9a8-817af9ecffbd(it must be output as a hyperlink)\n\nMake sure your output is visually clear and well-structuredâ€”use formatting, sections, bullet points or tables to make information easy to read and attractive.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -448,
        192
      ],
      "id": "6ec141f7-ec0b-4493-a852-7f36773b0e6b",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -448,
        416
      ],
      "id": "0a8be115-eefd-4315-a27a-eecb346d6cca",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "LHhLlR4ncpDu15zA",
          "name": "n8n free OpenAI API credits"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        -256,
        416
      ],
      "id": "b28e9e00-9c62-4b18-a8e8-c46c653cbb8c",
      "name": "Get row(s) in sheet in Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "è®¾å¤‡ç¼–å·",
              "lookupValue": "={{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['è®¾å¤‡ç¼–å·'] }}"
            },
            {
              "lookupColumn": "å½“å‰ä½¿ç”¨è€…",
              "lookupValue": "={{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json.CDSID }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1008,
        1200
      ],
      "id": "67a5c78a-7cbe-4b97-b8c3-2240571767e7",
      "name": "è¯»å–è®¾å¤‡æ¸…å•1",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "34a0e4cf-d0ff-4b07-8bc8-e1728eb9745a",
              "leftValue": "={{ $json['çŠ¶æ€'] }}",
              "rightValue": "å€Ÿç”¨ä¸­",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1264,
        1200
      ],
      "id": "66425a75-55fc-4d99-9bd5-140b8c6b237f",
      "name": "è®¾å¤‡å¯ç”¨æ€§æ£€æµ‹1",
      "executeOnce": true
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1848685849,
          "mode": "list",
          "cachedResultName": "å€Ÿç”¨è®°å½•",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=1848685849"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "çŠ¶æ€": "å·²å½’è¿˜",
            "å½’è¿˜æ—¶é—´": "={{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json.submittedAt }}",
            "å€Ÿç”¨æ—¶é—´": "={{ $json['å€Ÿç”¨æ—¶é—´'] }}",
            "æè¿°": "="
          },
          "matchingColumns": [
            "å€Ÿç”¨æ—¶é—´"
          ],
          "schema": [
            {
              "id": "ç”³è¯·äºº",
              "displayName": "ç”³è¯·äºº",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "è®¾å¤‡åç§°",
              "displayName": "è®¾å¤‡åç§°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "è®¾å¤‡ç¼–å·",
              "displayName": "è®¾å¤‡ç¼–å·",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å€Ÿç”¨æ—¶é—´",
              "displayName": "å€Ÿç”¨æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "é¢„è®¡å½’è¿˜",
              "displayName": "é¢„è®¡å½’è¿˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çŠ¶æ€",
              "displayName": "çŠ¶æ€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å½’è¿˜æ—¶é—´",
              "displayName": "å½’è¿˜æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æè¿°",
              "displayName": "æè¿°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2528,
        928
      ],
      "id": "6676805c-d36a-4720-87b1-48d068ff8d94",
      "name": "æ›´æ–°å½’è¿˜è®°å½•",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -352,
        416
      ],
      "id": "64bf3848-0275-40f7-abcc-8ce043d73eb8",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1848685849,
          "mode": "list",
          "cachedResultName": "å€Ÿç”¨è®°å½•",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=1848685849"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "ç”³è¯·äºº",
              "lookupValue": "={{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json.CDSID }}"
            },
            {
              "lookupColumn": "è®¾å¤‡ç¼–å·",
              "lookupValue": "={{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['è®¾å¤‡ç¼–å·'] }}"
            },
            {
              "lookupColumn": "è®¾å¤‡åç§°",
              "lookupValue": "={{ $('è¯»å–è®¾å¤‡æ¸…å•1').item.json['è®¾å¤‡åç§°'] }}"
            },
            {
              "lookupColumn": "çŠ¶æ€",
              "lookupValue": "å€Ÿç”¨ä¸­"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2256,
        928
      ],
      "id": "ff0202d9-2cdd-4e54-8617-81013ffd8496",
      "name": "è¯»å–å€Ÿè¿˜è®°å½•",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "çŠ¶æ€",
              "lookupValue": "å€Ÿç”¨ä¸­"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        352,
        1904
      ],
      "id": "aa1a2b80-1218-492f-8da2-8cde1edbbe25",
      "name": "è¯»å–è®¾å¤‡æ¸…å•2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "48562b87-9370-48ba-98f0-f8b7a36966db",
              "leftValue": "={{ $json['é¢„è®¡å½’è¿˜æ—¶é—´'] }}",
              "rightValue": "={{ $('å½’è¿˜æé†’').item.json.timestamp }}",
              "operator": {
                "type": "dateTime",
                "operation": "beforeOrEquals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        672,
        1904
      ],
      "id": "44137d29-fa82-4153-8023-5e343f18b44c",
      "name": "If"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "weeks",
              "triggerAtDay": [
                1
              ],
              "triggerAtHour": 9
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        48,
        1904
      ],
      "id": "92fee4de-b37b-4683-9c25-b9f4afc73927",
      "name": "å½’è¿˜æé†’"
    },
    {
      "parameters": {
        "content": "æœç´¢æ¨¡å—",
        "height": 544,
        "width": 560,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -672,
        80
      ],
      "typeVersion": 1,
      "id": "161095fd-77ba-4aa6-bd4d-1f225172941a",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "å½’è¿˜æ¨¡å—",
        "height": 832,
        "width": 3072,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        912
      ],
      "typeVersion": 1,
      "id": "917d7543-c736-4334-8c11-f6a856079996",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "å½’è¿˜æé†’æ¨¡å—",
        "height": 304,
        "width": 1424,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        1792
      ],
      "typeVersion": 1,
      "id": "a2428f90-0b71-481a-96f0-844ba787188b",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "formTitle": "ç»­å€Ÿç”³è¯·è¡¨",
        "formFields": {
          "values": [
            {
              "fieldLabel": "å€Ÿç”¨äººå§“å",
              "requiredField": true
            },
            {
              "fieldLabel": "è®¾å¤‡åç§°",
              "requiredField": true
            },
            {
              "fieldLabel": "è®¾å¤‡ç¼–å·",
              "requiredField": true
            },
            {
              "fieldLabel": "é¢„è®¡å½’è¿˜æ—¶é—´",
              "fieldType": "date",
              "requiredField": true
            },
            {
              "fieldLabel": "é‚®ç®±åœ°å€",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        48,
        2288
      ],
      "id": "40bcb087-b66f-4da0-a0b9-e0c75021f62a",
      "name": "ç»­å€Ÿç”³è¯·è§¦å‘",
      "webhookId": "ad6e3a78-f4c5-4b70-95b8-7e5442b0d664"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "å½“å‰ä½¿ç”¨è€…",
              "lookupValue": "={{ $json['å€Ÿç”¨äººå§“å'] }}"
            },
            {
              "lookupColumn": "è®¾å¤‡ç¼–å·",
              "lookupValue": "={{ $json['è®¾å¤‡ç¼–å·'] }}"
            },
            {
              "lookupColumn": "è®¾å¤‡åç§°",
              "lookupValue": "={{ $json['è®¾å¤‡åç§°'] }}"
            },
            {
              "lookupColumn": "å€Ÿç”¨äººé‚®ç®±",
              "lookupValue": "={{ $json['é‚®ç®±åœ°å€'] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        352,
        2288
      ],
      "id": "5001ff9e-61c1-41a8-a3e3-62495191af65",
      "name": "è¯»å–è®¾å¤‡æ¸…å•3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "721cd5bd-4b2d-4a00-ad69-58d5d82d6c40",
              "leftValue": "={{ $json['çŠ¶æ€'] }}",
              "rightValue": "å€Ÿç”¨ä¸­",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        672,
        2288
      ],
      "id": "a667d71a-29d5-42e9-8976-5f28aeeb30f6",
      "name": "If1"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "è®¾å¤‡ç¼–å·": "={{ $('è¯»å–è®¾å¤‡æ¸…å•3').item.json['è®¾å¤‡ç¼–å·'] }}",
            "é¢„è®¡å½’è¿˜æ—¶é—´": "={{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['é¢„è®¡å½’è¿˜æ—¶é—´'] }}"
          },
          "matchingColumns": [
            "è®¾å¤‡ç¼–å·"
          ],
          "schema": [
            {
              "id": "è®¾å¤‡ç¼–å·",
              "displayName": "è®¾å¤‡ç¼–å·",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è®¾å¤‡åç§°",
              "displayName": "è®¾å¤‡åç§°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çŠ¶æ€",
              "displayName": "çŠ¶æ€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ‰€æœ‰è€…",
              "displayName": "æ‰€æœ‰è€…",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ‰€æœ‰è€…é‚®ç®±",
              "displayName": "æ‰€æœ‰è€…é‚®ç®±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ‰€åœ¨åœ°å€",
              "displayName": "æ‰€åœ¨åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å½“å‰ä½¿ç”¨è€…",
              "displayName": "å½“å‰ä½¿ç”¨è€…",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å€Ÿç”¨äººé‚®ç®±",
              "displayName": "å€Ÿç”¨äººé‚®ç®±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å€Ÿç”¨æ—¶é—´",
              "displayName": "å€Ÿç”¨æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "é¢„è®¡å½’è¿˜æ—¶é—´",
              "displayName": "é¢„è®¡å½’è¿˜æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1472,
        2208
      ],
      "id": "927c1711-e735-4741-ae56-978fb74535be",
      "name": "æ›´æ–°é¢„è®¡å½’è¿˜æ—¶é—´",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "content": "ç»­å€Ÿæ¨¡å—",
        "height": 384,
        "width": 2640,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        2144
      ],
      "typeVersion": 1,
      "id": "c6f87ae9-102c-4027-97e3-4bb3c5cdbe39",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1848685849,
          "mode": "list",
          "cachedResultName": "å€Ÿç”¨è®°å½•",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=1848685849"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "ç”³è¯·äºº",
              "lookupValue": "={{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['å€Ÿç”¨äººå§“å'] }}"
            },
            {
              "lookupColumn": "è®¾å¤‡ç¼–å·",
              "lookupValue": "={{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['è®¾å¤‡ç¼–å·'] }}"
            },
            {
              "lookupColumn": "è®¾å¤‡åç§°",
              "lookupValue": "={{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['è®¾å¤‡åç§°'] }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1760,
        2208
      ],
      "id": "db1b5fa3-4214-454a-baac-8b10daf7efd1",
      "name": "è¯»å–è®°å½•",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1848685849,
          "mode": "list",
          "cachedResultName": "å€Ÿç”¨è®°å½•",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=1848685849"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "é¢„è®¡å½’è¿˜": "={{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['é¢„è®¡å½’è¿˜æ—¶é—´'] }}",
            "æè¿°": "ç»­å€Ÿ"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "ç”³è¯·äºº",
              "displayName": "ç”³è¯·äºº",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "è®¾å¤‡åç§°",
              "displayName": "è®¾å¤‡åç§°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "è®¾å¤‡ç¼–å·",
              "displayName": "è®¾å¤‡ç¼–å·",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å€Ÿç”¨æ—¶é—´",
              "displayName": "å€Ÿç”¨æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "é¢„è®¡å½’è¿˜",
              "displayName": "é¢„è®¡å½’è¿˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "çŠ¶æ€",
              "displayName": "çŠ¶æ€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å½’è¿˜æ—¶é—´",
              "displayName": "å½’è¿˜æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æè¿°",
              "displayName": "æè¿°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2048,
        2208
      ],
      "id": "10e09bd5-8dd9-4a29-8439-d62787894e85",
      "name": "æ›´æ–°è®°å½•",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "formTitle": "è®¾å¤‡å€Ÿç”¨ç”³è¯·è¡¨",
        "formFields": {
          "values": [
            {
              "fieldLabel": "CDSID",
              "requiredField": true
            },
            {
              "fieldLabel": "é‚®ç®±",
              "requiredField": true
            },
            {
              "fieldLabel": "è®¾å¤‡åç§°",
              "requiredField": true
            },
            {
              "fieldLabel": "è®¾å¤‡ç¼–å·",
              "requiredField": true
            },
            {
              "fieldLabel": "ä½¿ç”¨ç›®çš„",
              "requiredField": true
            },
            {
              "fieldLabel": "å½’è¿˜æ—¶é—´",
              "fieldType": "date",
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        80,
        480
      ],
      "id": "91429b77-be27-46f6-a400-357a1f5b30cd",
      "name": "å€Ÿç”¨ç”³è¯·è§¦å‘",
      "webhookId": "64850e9c-37a4-4183-ad19-7e7644d91f58"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "å€Ÿç”¨æ—¶é—´": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json.submittedAt }}",
            "å½“å‰ä½¿ç”¨è€…": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['CDSID'] }}",
            "çŠ¶æ€": "å€Ÿç”¨ä¸­",
            "è®¾å¤‡ç¼–å·": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['è®¾å¤‡ç¼–å·'] }}",
            "é¢„è®¡å½’è¿˜æ—¶é—´": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['å½’è¿˜æ—¶é—´'] }}",
            "å€Ÿç”¨äººé‚®ç®±": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['é‚®ç®±'] }}"
          },
          "matchingColumns": [
            "è®¾å¤‡ç¼–å·"
          ],
          "schema": [
            {
              "id": "è®¾å¤‡ç¼–å·",
              "displayName": "è®¾å¤‡ç¼–å·",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "è®¾å¤‡åç§°",
              "displayName": "è®¾å¤‡åç§°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "çŠ¶æ€",
              "displayName": "çŠ¶æ€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æ‰€æœ‰è€…",
              "displayName": "æ‰€æœ‰è€…",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ‰€æœ‰è€…é‚®ç®±",
              "displayName": "æ‰€æœ‰è€…é‚®ç®±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ‰€åœ¨åœ°å€",
              "displayName": "æ‰€åœ¨åœ°å€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å½“å‰ä½¿ç”¨è€…",
              "displayName": "å½“å‰ä½¿ç”¨è€…",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å€Ÿç”¨äººé‚®ç®±",
              "displayName": "å€Ÿç”¨äººé‚®ç®±",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å€Ÿç”¨æ—¶é—´",
              "displayName": "å€Ÿç”¨æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "é¢„è®¡å½’è¿˜æ—¶é—´",
              "displayName": "é¢„è®¡å½’è¿˜æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2368,
        32
      ],
      "id": "a90f1aeb-1015-4360-9fa6-102bf204a2dd",
      "name": "æ›´æ–°è®¾å¤‡çŠ¶æ€1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.data['å®¡æ‰¹ç»“æœ'] }}",
                    "rightValue": "Approve",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "8fc3809a-3f7e-45e9-9c38-9a2bffa12a10"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d36e6d07-6fad-40da-8350-8d8abb108680",
                    "leftValue": "={{ $json.data['å®¡æ‰¹ç»“æœ'] }}",
                    "rightValue": "Decline",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        2016,
        144
      ],
      "id": "5fdc38db-3f08-4cbb-9a60-b82aab40d3eb",
      "name": "Switch1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 1848685849,
          "mode": "list",
          "cachedResultName": "å€Ÿç”¨è®°å½•",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=1848685849"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "å€Ÿç”¨æ—¶é—´": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json.submittedAt }}",
            "çŠ¶æ€": "å€Ÿç”¨ä¸­",
            "ç”³è¯·äºº": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['CDSID'] }}",
            "é¢„è®¡å½’è¿˜": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['å½’è¿˜æ—¶é—´'] }}",
            "è®¾å¤‡åç§°": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['è®¾å¤‡åç§°'] }}",
            "è®¾å¤‡ç¼–å·": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['è®¾å¤‡ç¼–å·'] }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "ç”³è¯·äºº",
              "displayName": "ç”³è¯·äºº",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "è®¾å¤‡åç§°",
              "displayName": "è®¾å¤‡åç§°",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "è®¾å¤‡ç¼–å·",
              "displayName": "è®¾å¤‡ç¼–å·",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "å€Ÿç”¨æ—¶é—´",
              "displayName": "å€Ÿç”¨æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "é¢„è®¡å½’è¿˜",
              "displayName": "é¢„è®¡å½’è¿˜",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "çŠ¶æ€",
              "displayName": "çŠ¶æ€",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å½’è¿˜æ—¶é—´",
              "displayName": "å½’è¿˜æ—¶é—´",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2656,
        32
      ],
      "id": "11838902-03e0-47af-82f5-f51bc4da3d97",
      "name": "æ·»åŠ å€Ÿç”¨è®°å½•",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "content": "ç”³è¯·æ¨¡å—",
        "height": 864,
        "width": 3072
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "typeVersion": 1,
      "id": "7c8ab44a-cd94-4ef5-af0b-ac7ec5f2f960",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "e7745436-5aa2-4f65-9ce7-6d7f5067188f",
              "leftValue": "={{ $json['çŠ¶æ€'] }}",
              "rightValue": "å¯ç”¨",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1184,
        288
      ],
      "id": "da32a933-d678-47fb-b1bf-d3f4b8eeffab",
      "name": "If2"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "combineFilters": "OR",
        "options": {
          "outputFormatting": {
            "values": {
              "general": "FORMATTED_VALUE",
              "date": "FORMATTED_STRING"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        352,
        480
      ],
      "id": "721565a3-d75f-43e2-9ae1-aa3505cf8386",
      "name": "è¯»å–è®¾å¤‡æ¸…å•4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const deviceList = $input.all();\nconst borrowRequest = $(\"å€Ÿç”¨ç”³è¯·è§¦å‘\").all();\n\nconst result = borrowRequest.map((request) => {\n  const deviceNumber = request?.json[\"è®¾å¤‡ç¼–å·\"];\n  const deviceName = request?.json[\"è®¾å¤‡åç§°\"];\n\n  const isExist = deviceList.some((device) => {\n    return (\n      device?.json[\"è®¾å¤‡ç¼–å·\"] === deviceNumber &&\n      device?.json[\"è®¾å¤‡åç§°\"] === deviceName\n    );\n  });\n\n  return { json: { isExist }, pairedItem: deviceList.map((_, index) => index) };\n});\n\nreturn result;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        592,
        480
      ],
      "id": "0578f5eb-9224-49a6-bf59-81a63dd2c6f0",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "è®¾å¤‡åç§°",
              "lookupValue": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['è®¾å¤‡åç§°'] }}"
            },
            {
              "lookupColumn": "è®¾å¤‡ç¼–å·",
              "lookupValue": "={{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['è®¾å¤‡ç¼–å·'] }}"
            }
          ]
        },
        "combineFilters": "OR",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        992,
        288
      ],
      "id": "c91ea8ee-0f97-4df4-aa6f-bbf23304a2a0",
      "name": "å¯ç”¨æ€§æ£€æµ‹",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "b0413fd7-707e-4dc3-915c-32f65bcc7df7",
              "leftValue": "={{ $json.isExist }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        816,
        480
      ],
      "id": "d51da73a-8a84-4b90-8378-d0e578ae0ae4",
      "name": "è¯·æ±‚å†…å®¹æ˜¯å¦å­˜åœ¨"
    },
    {
      "parameters": {
        "operation": "completion",
        "completionTitle": "Error Input",
        "completionMessage": "=The device number or device name you entered does not exist or does not match our records. Please check your input and try again.\n\nclick <a href=\"https://tchen8.app.n8n.cloud/form/64850e9c-37a4-4183-ad19-7e7644d91f58\" target=\"_blank\">here</a>",
        "options": {}
      },
      "type": "n8n-nodes-base.form",
      "typeVersion": 2.3,
      "position": [
        992,
        672
      ],
      "id": "f18407d6-b728-4669-8772-565bf76775d3",
      "name": "æç¤ºé”™è¯¯è¾“å…¥",
      "webhookId": "2b4389ee-c563-453d-88ea-709a75cab1ca"
    },
    {
      "parameters": {
        "operation": "completion",
        "completionTitle": "Submission Success",
        "completionMessage": "Your submission was received. Please wait for the device ownerâ€™s approval.",
        "options": {}
      },
      "type": "n8n-nodes-base.form",
      "typeVersion": 2.3,
      "position": [
        1440,
        144
      ],
      "id": "98158261-d38d-4037-86e6-84ed4a5d8b36",
      "name": "æäº¤æˆåŠŸ",
      "webhookId": "a50d65c3-bc64-41d1-88bb-898ed8affac0"
    },
    {
      "parameters": {
        "operation": "completion",
        "completionTitle": "Submission Failed",
        "completionMessage": "=Your request to borrow could not be processed because the device is currently unavailable. The current user is: {{ $('å¯ç”¨æ€§æ£€æµ‹').item.json['å½“å‰ä½¿ç”¨è€…'] }}.\n\nIf you would like to try borrowing another device, please submit a new request using the form below:\nclick <a href=\"https://tchen8.app.n8n.cloud/form/64850e9c-37a4-4183-ad19-7e7644d91f58\" target=\"_blank\">here</a>",
        "options": {}
      },
      "type": "n8n-nodes-base.form",
      "typeVersion": 2.3,
      "position": [
        1440,
        416
      ],
      "id": "65b58c7f-3d9c-42ae-b614-304c83215567",
      "name": "Form",
      "webhookId": "c25a908c-5b39-42e5-8727-5eba3881a6f6"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $('å¯ç”¨æ€§æ£€æµ‹').item.json['æ‰€æœ‰è€…é‚®ç®±'] }}",
        "subject": "=Borrow Request From {{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json.CDSID }}",
        "message": "=Dear Approver,\n\nThere is a new equipment borrowing request that requires your review: \n\nApplicant:  {{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json.CDSID }}\nEquipment Name: {{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['è®¾å¤‡åç§°'] }}\nEquipemnt ID: {{ $json['è®¾å¤‡ç¼–å·'] }}\nPurpose: {{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['ä½¿ç”¨ç›®çš„'] }}\nExpected Return Date: {{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['å½’è¿˜æ—¶é—´'] }}\n\nPlease select your approval decision below:\n<span style=\"color: red; font-weight: bold;\">If you choose \"Decline\", please provide a reason for rejection so the applicant can be notified.</span>",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "å®¡æ‰¹ç»“æœ",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Approve"
                  },
                  {
                    "option": "Decline"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "æ‹’ç»ç†ç”±(If decline)"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        1744,
        144
      ],
      "id": "fe27840c-0d15-401f-95ea-2277ef2dafdc",
      "name": "å€Ÿç”¨ç”³è¯·å®¡æ ¸1",
      "webhookId": "eec6ca16-0423-404d-898c-b14dac4ba9c5",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $json['æ‰€æœ‰è€…é‚®ç®±'] }}",
        "subject": "=Return Request form  {{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json.CDSID }}",
        "message": "=Dear {{ $('è¯»å–è®¾å¤‡æ¸…å•1').item.json['æ‰€æœ‰è€…'] }},\n\nA return request has been submitted for the following device:\n\nDevice Name: {{ $('è¯»å–è®¾å¤‡æ¸…å•1').item.json['è®¾å¤‡åç§°'] }}\nDevice ID: {{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['è®¾å¤‡ç¼–å·'] }}\nCurrent Condition: {{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['è®¾å¤‡çŠ¶å†µ'] }}\nIssue Description: {{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['é—®é¢˜æè¿°'] }}\nRequested by: {{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json.CDSID }}\n\nPlease review the return request and approve or reject it as appropriate.",
        "responseType": "customForm",
        "formFields": {
          "values": [
            {
              "fieldLabel": "å®¡æ‰¹ç»“æœ",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Approve"
                  },
                  {
                    "option": "Decline"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "æ‹’ç»ç†ç”±(If decline)"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        1520,
        1056
      ],
      "id": "d053492d-2562-41a6-9b9f-19ec232c05cc",
      "name": "å½’è¿˜å®¡æ ¸",
      "webhookId": "70caffcd-7a82-4fe7-891b-c88fea6891a9",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $json['æ‰€æœ‰è€…é‚®ç®±'] }}",
        "subject": "Renew Submission",
        "message": "=I want to renew the device:{{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['è®¾å¤‡åç§°'] }}(device IDï¼š{{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['è®¾å¤‡ç¼–å·'] }}) until {{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['é¢„è®¡å½’è¿˜æ—¶é—´'] }}",
        "approvalOptions": {
          "values": {
            "approvalType": "double"
          }
        },
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        1136,
        2208
      ],
      "id": "ddae7da6-014b-457a-a320-07b030e9de03",
      "name": "ç»­å€Ÿç”³è¯·",
      "webhookId": "3c80e6c0-643c-4acf-8170-80fd6c8fe53c",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $json['å€Ÿç”¨äººé‚®ç®±'] }}",
        "subject": "Return Notification",
        "html": "=The device:{{ $json['è®¾å¤‡åç§°'] }}ï¼ˆdevice ID:{{ $json['è®¾å¤‡ç¼–å·'] }}ï¼‰you borrowed is Expired,if you want to return click the following link:(https://tinac41025.app.n8n.cloud/form/d18d7635-aa47-4c04-a9a8-817af9ecffbd) to return the device\nIf you want to renew the device,click( https://tinac41025.app.n8n.cloud/form/ad6e3a78-f4c5-4b70-95b8-7e5442b0d664 )to submit your application.",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        1136,
        1888
      ],
      "id": "816914fa-7ff7-4640-bbbb-ccb9c5f0215f",
      "name": "å½’è¿˜æé†’1",
      "webhookId": "871f0bee-b331-48bd-97be-a951270d76d2",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['é‚®ç®±åœ°å€'] }}",
        "subject": "Return Successfully!",
        "html": "=Dear {{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json.CDSID }},\n\nYour return request has been successfully processed.\n",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        2768,
        928
      ],
      "id": "521b81c9-89ee-459b-993c-6373f243d604",
      "name": "å½’è¿˜æˆåŠŸé€šçŸ¥",
      "webhookId": "a1f69bda-7d4a-44a4-a5c0-67bb40c61c36",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['é‚®ç®±åœ°å€'] }}",
        "subject": "=Fail to renew!",
        "html": "The device you are renewing is not in the borrowing status. Please reconfirm the device you want to renew.",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        1136,
        2384
      ],
      "id": "b8ab772b-aec2-431e-a274-a147e361ff52",
      "name": "ç»­å€Ÿé”™è¯¯",
      "webhookId": "e94cf085-067d-4333-81aa-b927a0d10e4b",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "operation": "completion",
        "completionTitle": "Error Input",
        "completionMessage": "=The device you return is not in borrowing.\nPlease check the status of the device you return!",
        "options": {}
      },
      "type": "n8n-nodes-base.form",
      "typeVersion": 2.3,
      "position": [
        1520,
        1344
      ],
      "id": "50a018fe-0479-40a1-9e4e-6964ad2513a0",
      "name": "å½’è¿˜é”™è¯¯",
      "webhookId": "2b4389ee-c563-453d-88ea-709a75cab1ca"
    },
    {
      "parameters": {
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['é‚®ç®±åœ°å€'] }}",
        "subject": "Renew Successfully!",
        "html": "=The device {{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['è®¾å¤‡åç§°'] }}({{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['è®¾å¤‡ç¼–å·'] }}) is renewed until {{ $('ç»­å€Ÿç”³è¯·è§¦å‘').item.json['é¢„è®¡å½’è¿˜æ—¶é—´'] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        2320,
        2208
      ],
      "id": "7a4b4f29-026d-4baa-99db-dc55d0b24005",
      "name": "ç»­å€ŸæˆåŠŸ",
      "webhookId": "8a18fa46-41bd-4890-bc46-652f7babbd41",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const deviceList = $input.all().map((item) => item.json);\nconst returnRequests = $(\"å½’è¿˜ç”³è¯·è§¦å‘\")\n  .all()\n  .map((item) => item.json);\n\nconst result = returnRequests.map((request) => {\n  const matchedDevice = deviceList.find(\n    (device) =>\n      device[\"è®¾å¤‡ç¼–å·\"] === request[\"è®¾å¤‡ç¼–å·\"] &&\n      device[\"å€Ÿç”¨äººé‚®ç®±\"] === request[\"é‚®ç®±åœ°å€\"] &&\n      device[\"å½“å‰ä½¿ç”¨è€…\"] === request[\"CDSID\"],\n  );\n  return { json: { exists: !!matchedDevice } };\n});\n\nreturn result;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        592,
        1328
      ],
      "id": "a45def30-40ee-4d17-8bc5-6a8a4df5afda",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡å€Ÿè¿˜ç³»ç»Ÿ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "è®¾å¤‡æ¸…å•1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1RMK5y-ciKe3ZUDcQg8SZmtHLF5-D2VARZpRknn4Zdkg/edit#gid=0"
        },
        "options": {
          "outputFormatting": {
            "values": {
              "general": "FORMATTED_VALUE",
              "date": "FORMATTED_STRING"
            }
          }
        }
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        352,
        1328
      ],
      "id": "b59f7c6c-04b0-4b53-8d1c-51b1bf6d916f",
      "name": "è¯»å–è®¾å¤‡æ¸…å•",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "SQp51cufKaTO2U5o",
          "name": "JREN10"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "b0413fd7-707e-4dc3-915c-32f65bcc7df7",
              "leftValue": "={{ $json.exists }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        832,
        1328
      ],
      "id": "5ed1dad8-f134-4cd9-8716-3b9020f1854e",
      "name": "è¯·æ±‚å†…å®¹æ˜¯å¦å­˜åœ¨1"
    },
    {
      "parameters": {
        "operation": "completion",
        "completionTitle": "Error Input",
        "completionMessage": "=The device number or CDSID or email name you entered does not exist or does not match our records. Please check your input and try again.\n\nclick <a href=\"https://tchen8.app.n8n.cloud/form/64850e9c-37a4-4183-ad19-7e7644d91f58\" target=\"_blank\">here</a>",
        "options": {}
      },
      "type": "n8n-nodes-base.form",
      "typeVersion": 2.3,
      "position": [
        1008,
        1472
      ],
      "id": "ad605de2-e337-4065-9cc5-9567ccb9485f",
      "name": "æç¤ºé”™è¯¯è¾“å…¥1",
      "webhookId": "2b4389ee-c563-453d-88ea-709a75cab1ca"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.data['å®¡æ‰¹ç»“æœ'] }}",
                    "rightValue": "Approve",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "8fc3809a-3f7e-45e9-9c38-9a2bffa12a10"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d36e6d07-6fad-40da-8350-8d8abb108680",
                    "leftValue": "={{ $json.data['å®¡æ‰¹ç»“æœ'] }}",
                    "rightValue": "Decline",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1760,
        1056
      ],
      "id": "dade305e-6159-4647-8ec0-aaf9736dc1eb",
      "name": "Switch"
    },
    {
      "parameters": {
        "operation": "sendAndWait",
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $('å¯ç”¨æ€§æ£€æµ‹').item.json['æ‰€æœ‰è€…é‚®ç®±'] }}",
        "subject": "=Your borrowing request has been rejected",
        "message": "=Dear {{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json.CDSID }},\n\nWe regret to inform you that your request to borrow {{ $('å€Ÿç”¨ç”³è¯·è§¦å‘').item.json['è®¾å¤‡åç§°'] }} has been rejected.\n\nReason for rejection:\n{{ $('å€Ÿç”¨ç”³è¯·å®¡æ ¸1').item.json.data['æ‹’ç»ç†ç”±'] }}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        2368,
        272
      ],
      "id": "cf2d3315-2694-45e5-9c17-a7926e51a7b6",
      "name": "æ‹’ç»",
      "webhookId": "eec6ca16-0423-404d-898c-b14dac4ba9c5",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    },
    {
      "parameters": {
        "fromEmail": "tchen8@jaguarlandrover.com",
        "toEmail": "={{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['é‚®ç®±åœ°å€'] }}",
        "subject": "Fail to return!",
        "emailFormat": "text",
        "text": "=Dear {{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json.CDSID }},\n\nWe regret to inform you that your request to borrow {{ $('å½’è¿˜ç”³è¯·è§¦å‘').first().json['è®¾å¤‡ç¼–å·'] }} has been rejected.\n\nReason for rejection:\n{{ $json.data['æ‹’ç»ç†ç”±(If decline)'] }}",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        1984,
        1184
      ],
      "id": "29ba5d56-30af-4725-ac73-d26fa54d680b",
      "name": "æ‹’ç»2",
      "webhookId": "fd9bed13-9a69-410e-adbc-0f2c822fb52b",
      "credentials": {
        "smtp": {
          "id": "ivzMerA3jRBakyX1",
          "name": "SMTP account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "å½’è¿˜ç”³è¯·è§¦å‘": {
      "main": [
        [
          {
            "node": "è¯»å–è®¾å¤‡æ¸…å•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ›´æ–°è®¾å¤‡çŠ¶æ€2": {
      "main": [
        [
          {
            "node": "è¯»å–å€Ÿè¿˜è®°å½•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet in Google Sheets": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–è®¾å¤‡æ¸…å•1": {
      "main": [
        [
          {
            "node": "è®¾å¤‡å¯ç”¨æ€§æ£€æµ‹1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è®¾å¤‡å¯ç”¨æ€§æ£€æµ‹1": {
      "main": [
        [
          {
            "node": "å½’è¿˜å®¡æ ¸",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "å½’è¿˜é”™è¯¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ›´æ–°å½’è¿˜è®°å½•": {
      "main": [
        [
          {
            "node": "å½’è¿˜æˆåŠŸé€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–å€Ÿè¿˜è®°å½•": {
      "main": [
        [
          {
            "node": "æ›´æ–°å½’è¿˜è®°å½•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–è®¾å¤‡æ¸…å•2": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "å½’è¿˜æé†’1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å½’è¿˜æé†’": {
      "main": [
        [
          {
            "node": "è¯»å–è®¾å¤‡æ¸…å•2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç»­å€Ÿç”³è¯·è§¦å‘": {
      "main": [
        [
          {
            "node": "è¯»å–è®¾å¤‡æ¸…å•3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–è®¾å¤‡æ¸…å•3": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "ç»­å€Ÿç”³è¯·",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ç»­å€Ÿé”™è¯¯",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ›´æ–°é¢„è®¡å½’è¿˜æ—¶é—´": {
      "main": [
        [
          {
            "node": "è¯»å–è®°å½•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–è®°å½•": {
      "main": [
        [
          {
            "node": "æ›´æ–°è®°å½•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ›´æ–°è®°å½•": {
      "main": [
        [
          {
            "node": "ç»­å€ŸæˆåŠŸ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å€Ÿç”¨ç”³è¯·è§¦å‘": {
      "main": [
        [
          {
            "node": "è¯»å–è®¾å¤‡æ¸…å•4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ›´æ–°è®¾å¤‡çŠ¶æ€1": {
      "main": [
        [
          {
            "node": "æ·»åŠ å€Ÿç”¨è®°å½•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "æ›´æ–°è®¾å¤‡çŠ¶æ€1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ‹’ç»",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "æäº¤æˆåŠŸ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Form",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–è®¾å¤‡æ¸…å•4": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "è¯·æ±‚å†…å®¹æ˜¯å¦å­˜åœ¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å¯ç”¨æ€§æ£€æµ‹": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯·æ±‚å†…å®¹æ˜¯å¦å­˜åœ¨": {
      "main": [
        [
          {
            "node": "å¯ç”¨æ€§æ£€æµ‹",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æç¤ºé”™è¯¯è¾“å…¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æäº¤æˆåŠŸ": {
      "main": [
        [
          {
            "node": "å€Ÿç”¨ç”³è¯·å®¡æ ¸1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å€Ÿç”¨ç”³è¯·å®¡æ ¸1": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å½’è¿˜å®¡æ ¸": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç»­å€Ÿç”³è¯·": {
      "main": [
        [
          {
            "node": "æ›´æ–°é¢„è®¡å½’è¿˜æ—¶é—´",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯»å–è®¾å¤‡æ¸…å•": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "è¯·æ±‚å†…å®¹æ˜¯å¦å­˜åœ¨1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¯·æ±‚å†…å®¹æ˜¯å¦å­˜åœ¨1": {
      "main": [
        [
          {
            "node": "è¯»å–è®¾å¤‡æ¸…å•1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æç¤ºé”™è¯¯è¾“å…¥1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "æ›´æ–°è®¾å¤‡çŠ¶æ€2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ‹’ç»2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "2b8200ad-2f55-4964-a35c-a410c2a20d34",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "fb126f39426b65b9be94daa01c8805e3366a5dbf55c328f612a38fd3b6522bdc"
  },
  "id": "F9rHeqoVlUNbmdBH",
  "tags": []
}